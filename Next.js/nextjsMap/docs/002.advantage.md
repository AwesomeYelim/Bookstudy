# nextjs 의 장점

## 1.next 프로젝트 캐싱된것 확인

inspector 에 들어가서 header에 x-vercel-cache : HIT 라는 헤더를 확인할 수 있는데, vercel 에서 캐시를 해두기 때문에 임의로 브라우저 캐시를 꺼두어도 새로고침할때마다 캐시된 html을 똑같이 받을 수 있다.(etag 도 마찬가지)

## 2.nextjs 과 react cra의 가장 큰 차이점(pre-rendering)

inspector 에 들어가서 js 사용중지 옵션을 클릭하고 새로고침하면 nextjs 는 이미 정적으로 형성된 html을 볼수 있지만 react는 아직 dom에서 그려지지 않았기 때문에 다음과 같은 빈화면이 출력됨

![00146](./img/00146.png)

## 3.a 태그와 Link 의 차이점

### next/link

- next 에서는 최초 랜더랑시 페이지의 html을 불러온다. 하지만 Link 를 통해 페이지 이동시에는 추가적인 html 을 받아오지 않는다. inspector를 확인하면 해당 (이동되는)페이지에 관한 자바스크립트 파일만 가져오는것을 확인 할 수 있다.

- 즉, 최초 실행은 SSG로 실행되지만 페이지를 라우팅 할때는 CSR 방식으로 빠르게 이동한다는 뜻

- 반대로 (이동된) 페이지에서 새로고침을 하면 이 페이지에 해당하는 html을 받아오고 뒤로가기를 눌렀을시 이전페이지에 해당하는 자바스크립트 파일만 가져오고 html 문서는 따로 불러오지 않는다.

### a 태그

- 첫 랜더링시 html 문서도 자바스크립트 파일도 오지않다가 화면 이동시 html 파일을 불러옴

- 즉, 화면 이동시 마다 html 파일을 받아와야한다.

### next/link 의 이점

- 화면이동시 마다 해당 html에 관한 자바스크립트 파일을 이미 가지고 있기 때문에 CSR 방식으로 DOM을 렌더링 할 수 있음.
- 즉, json 파일과 자바스크립트 파일의 결합으로 바로 DOM을 업데이트 할 수 있다는 것임

### 정리하자면

1. 최초 한번만 html 파일을 가져옴
2. next/link 가 있는곳은 자바스크립트와 json 파일로 해당 페이지에 대한 정보를 미리가져옴
3. 가져온 정보를 기반으로 빠르게 CSR 방식으로 라우팅 할수 있음

- 페이지마다의 html 도 이미 프리랜더링 되어있기 때문에 SEO도 문제가 없음

### 🚩 만약에 브라우저 밖(예를들면 스크롤 범위 끝)에 데이터가 있다면 ?

- 첫 랜더링시 아무 것도 받아오질 않다가 브라우저 내에 데이터가 보여지게되면 html 파일을 불러오게 된다. => lazy 한 방식으로 파일을 가져온다는 뜻임

- 이러한 방식으로 next는 불필요한 네트워크 요청을 지양한다.(빠른 routing 과 적은 네트워크 요청 베리굿 !)

## 4.next/router 로 routing 하기

- router 는 자동으로 pre-rendering 을 하지않기 때문에 다음과 같이 router.prefetch 를 통해 직접 코드를 작성해야 한다.

```jsx
useEffect(() => {
  router.prefetch("pre-rendering 할 url");
}, [router]);
```
